services:
  api:
    image: ${MEOW_AI_API_IMAGE:-meow-ai-api:latest}
    container_name: meow-ai-api
    pull_policy: always
    restart: unless-stopped
    volumes:
      - ./config.yaml:/config/config.yaml:ro
    networks:
      - app
    expose:
      - "8080"

  web:
    image: ${MEOW_AI_WEB_IMAGE:-meow-ai-web:latest}
    container_name: meow-ai-web
    pull_policy: always
    restart: unless-stopped
    depends_on:
      - api
    ports:
      - "${MEOW_AI_WEB_PORT:-80}:80"
    networks:
      - app

  watchtower:
    image: containrrr/watchtower:latest
    container_name: meow-ai-watchtower
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - WATCHTOWER_POLL_INTERVAL=300
      - WATCHTOWER_CLEANUP=true
      - WATCHTOWER_INCLUDE_STOPPED=true
    command:
      - meow-ai-api
      - meow-ai-web
    networks:
      - app

networks:
  app:
    driver: bridge

